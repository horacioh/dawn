{% comment %}
  Renders a clean square product item for mobile carousel

  Accepts:
  - product: {Object} Product Liquid object (required)
  - loading: {String} Image loading behavior. Default: 'eager' (optional)

  Usage:
  {% render 'mobile-carousel-product', product: product, loading: 'lazy' %}
{% endcomment %}

{%- if product and product != empty -%}
  {%- liquid
    # Get custom menu image from metafields or fallback to featured image
    assign menu_image = product.metafields.menu.featured_image
    if menu_image
      assign product_image = menu_image
    else
      assign product_image = product.featured_image
    endif
  -%}

  <div class="mobile-carousel-product">
    <a href="{{ product.url }}" class="mobile-carousel-product__link" aria-label="{{ product.title | escape }}">
      {%- if product_image -%}
        {%- assign loading_strategy = loading | default: 'lazy' -%}
        {%- assign image_alt = product_image.alt | default: product.title | escape -%}
        {{
          product_image
          | image_url: width: 200, height: 200
          | image_tag:
            class: 'mobile-carousel-product__image',
            widths: '100,200',
            sizes: '100px',
            alt: image_alt,
            loading: loading_strategy
        }}
      {%- else -%}
        <div class="mobile-carousel-product__image mobile-carousel-product__image--placeholder">
          {{ 'image' | placeholder_svg_tag: 'mobile-carousel-product__placeholder-svg' }}
        </div>
      {%- endif -%}
    </a>
  </div>
{%- endif -%}
